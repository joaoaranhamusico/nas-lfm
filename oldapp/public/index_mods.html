<!doctype html>
<html>
  <head>
    <title>NAS Mods Console</title>
    <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css">
    <style type="text/css">
        #login {
            display: block;
        }
        #loggedin{
            display: none;
        }
        .text-overflow {
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            width: 500px;
        }
        hr.dashed {
            border-top: 3px dashed #bbb;
        }
    </style>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
  </head>

  <body onload="onBodyLoaded()">
    <div class="container">
      <div id="login">
        <h1>NAS Mods Console</h1>
        <h3 id="welcomeMessage"></h3>
        <a id="loginButton" href="https://spotifyfollow.a2hosted.com/" onclick="location.href=this.href+ENVIRONMENT+'/'+PAGE+'_login';return false;" class="btn btn-primary">Login</a><br/>
      </div>
      <div id="loggedin">
        <h1>NAS Mods Console</h1>
        <h3 id="results1"></h3>
        <a id="logoutButton" onClick="onLogoutPressed()" class="btn btn-primary">Logout</a>
        <hr class="dashed">
        <h3 id="results1">What would you like to do?</h3>
        
        <input type="radio" id="report" onclick="radioClicked(this.value)" name="task" value="GetFullReport">
        <label for="report">Get Full Report For User</label><br>
        <input type="radio" id="leaderboard" onclick="radioClicked(this.value)" name="task" value="PrintLeaderboard">
        <label for="leaderboard">Print Leaderboard</label><br>
        <input type="radio" id="bonusPointsToUser" onclick="radioClicked(this.value)" name="task" value="AddBonusPointsToUser">
        <label for="bonusPointsToUser">Add Bonus Points To User</label><br>
        <input type="radio" id="bonusPointsToRole" onclick="radioClicked(this.value)" name="task" value="AddBonusPointsToRole">
        <label for="bonusPointsToRole">Add Bonus Points To Role</label><br>
        <input type="radio" id="printTierToDiscord" onclick="radioClicked(this.value)" name="task" value="PrintTierToDiscord">
        <label for="printTierToDiscord">Print Tier User List</label><br>
        <input type="radio" id="exportModPoints" onclick="radioClicked(this.value)" name="task" value="ExportModPoints">
        <label for="exportModPoints">Export Mod Points</label><br>
        <input type="radio" id="exportBonusPoints" onclick="radioClicked(this.value)" name="task" value="ExportBonusPoints">
        <label for="exportBonusPoints">Export Bonus Points</label><br>
        
        <hr class="dashed" id="choiceDash">
        
        <h3 id="taskDescription"></h3>
        <div id="DiscordIdDiv">
            <label for="discordid_box">Discord User Id</label>
            <input type="text" id="discordid_box" name="discordid_box" value=""><br/>
        </div>
        <div id="UserSelectDiv">
            <input type="radio" id="tierAll" onclick="userTierRadioClicked(this.value)" name="tier" value="tierAll" checked>
            <label for="tierAll">All</label><br>
            <input type="radio" id="tier0" onclick="userTierRadioClicked(this.value)" name="tier" value="tier0">
            <label for="tier0">Tier 0</label><br>
            <input type="radio" id="tier1" onclick="userTierRadioClicked(this.value)" name="tier" value="tier1">
            <label for="tier1">Tier 1</label><br>
            <input type="radio" id="tier2" onclick="userTierRadioClicked(this.value)" name="tier" value="tier2">
            <label for="tier2">Tier 2</label><br>
            <input type="radio" id="tier3" onclick="userTierRadioClicked(this.value)" name="tier" value="tier3">
            <label for="tier3">Tier 3</label><br>
            <input type="radio" id="tier4" onclick="userTierRadioClicked(this.value)" name="tier" value="tier4">
            <label for="tier4">Tier 4</label><br>
            <input type="radio" id="tier5" onclick="userTierRadioClicked(this.value)" name="tier" value="tier5">
            <label for="tier5">Tier 5</label><br>
            <input type="radio" id="tier6" onclick="userTierRadioClicked(this.value)" name="tier" value="tier6">
            <label for="tier6">Tier 6</label><br>
            <input type="radio" id="tier7" onclick="userTierRadioClicked(this.value)" name="tier" value="tier7">
            <label for="tier7">Tier 7</label><br>
            <input type="radio" id="tier8" onclick="userTierRadioClicked(this.value)" name="tier" value="tier8">
            <label for="tier8">Tier 8</label><br>
            <input type="radio" id="mods" onclick="userTierRadioClicked(this.value)" name="tier" value="mods">
            <label for="mods">Mods</label><br>
            
            <label for="discordUsers">Discord User</label>
            <select name="discordUsers" id="discordUsers" onchange="onDiscordUserSelected()">
            </select><br/>
        </div>
        <div id="FullReportDiv">
            <input type="radio" id="currentweek" onclick="weekClicked(this.value)" name="week" value="CurrentWeek" checked>
            <label for="currentweek">Current Week</label><br>
            <input type="radio" id="previousweek" onclick="weekClicked(this.value)" name="week" value="PreviousWeek">
            <label for="previousweek">Previous Week</label><br>
            <input type="radio" id="twoweeksago" onclick="weekClicked(this.value)" name="week" value="TwoWeeksAgo">
            <label for="twoweeksago">Two Weeks Ago</label><br>
            <button id="fullReport" onClick="onFullReportButtonPressed()" class="btn btn-primary">Get Full Report</button>
        </div>
        <div id="PrintLeaderboardDiv">
            <label for="leaderboardlength">Length of Leaderboard</label>
            <input type="text" id="leaderboardlength" name="leaderboardlength" value="10"><br/>
            <button id="printLeaderboard" onClick="onPrintLeaderboardButtonPressed()" class="btn btn-primary">Print Leaderboard To Discord</button>
        </div>
        <div id="pointsPresetDiv">
            <label for="pointsPreset">Preset Point Options</label>
            <select name="pointsPreset" id="pointsPreset" onchange="onPointsPresetSelected()">
            </select><br/>
        </div>
        <div id="AddBonusPointsToUserDiv">
            <label for="pointsamount_box">Points Amount</label>
            <input type="text" id="pointsamount_box" name="pointsamount_box" value=""><br/>
            <label for="pointsreason_box">Reason For Bonus Points</label>
            <input type="text" id="pointsreason_box" name="pointsreason_box" value=""><br/>
            <button id="bonusPointsToUserButton" onClick="onBonusPointsToUserButtonPressed()" class="btn btn-primary">Add Bonus Points</button>
        </div>
        <div id="AddBonusPointsToRoleDiv">
            <label for="discordRoles">Discord Role</label>
            <select name="discordRoles" id="discordRoles" onchange="onDiscordRolesSelected()">
            </select><br/>
            <label for="rolepointsamount_box">Points Amount</label>
            <input type="text" id="rolepointsamount_box" name="rolepointsamount_box" value=""><br/>
            <label for="rolepointsreason_box">Reason For Bonus Points</label>
            <input type="text" id="rolepointsreason_box" name="rolepointsreason_box" value=""><br/>
            <button id="bonusPointsToRoleButton" onClick="onBonusPointsToRoleButtonPressed()" class="btn btn-primary">Add Bonus Points</button>
        </div>
        <div id="PrintTierDiv">
            <label for="tier_box">Tier</label>
            <input type="text" id="tier_box" name="tier_box" value="0"><br/>
            <button id="printTierToDiscordButton" onClick="onPrintTierToDiscordButtonPressed()" class="btn btn-primary">Print Tier To Discord</button>
        </div>
        <div id="ExportModPointsDiv">
            <input type="radio" id="modCurrentweek" onclick="weekClicked(this.value)" name="week" value="CurrentWeek" checked>
            <label for="modCurrentweek">Current Week</label><br>
            <input type="radio" id="modPreviousweek" onclick="weekClicked(this.value)" name="week" value="PreviousWeek">
            <label for="modPreviousweek">Previous Week</label><br>
            <input type="radio" id="modTwoweeksago" onclick="weekClicked(this.value)" name="week" value="TwoWeeksAgo">
            <label for="modTwoweeksago">Two Weeks Ago</label><br>
            <button id="exportModPointsbutton" onClick="onExportModPointsbuttonPressed()" class="btn btn-primary">Get Mods Report</button>
        </div>
        <div id="ExportBonusPointsDiv">
            <input type="radio" id="bonusCurrentweek" onclick="weekClicked(this.value)" name="week" value="CurrentWeek" checked>
            <label for="bonusCurrentweek">Current Week</label><br>
            <input type="radio" id="bonusCurrentweek" onclick="weekClicked(this.value)" name="week" value="PreviousWeek">
            <label for="bonusCurrentweek">Previous Week</label><br>
            <input type="radio" id="bonusCurrentweek" onclick="weekClicked(this.value)" name="week" value="TwoWeeksAgo">
            <label for="bonusCurrentweek">Two Weeks Ago</label><br>
            <button id="exportBonusPointsbutton" onClick="onExportBonusPointsbuttonPressed()" class="btn btn-primary">Get Bonus Points Report</button>
        </div>
        
        <hr class="dashed" id="resultsDash">
        <h3 id="results2"></h3>
        <h3 id="results3"></h3>
        <h3 id="results4"></h3>
        <h3 id="results5"></h3>
        <h3 id="results6"></h3>
        <h3 id="results7"></h3>
      </div>
    </div>

    <script src="//cdnjs.cloudflare.com/ajax/libs/handlebars.js/2.0.0-alpha.1/handlebars.min.js"></script>
    <script src="http://code.jquery.com/jquery-1.10.1.min.js"></script>

    <script>
        
        function getEnvironmentFromURL()
        {
            var prefix = "https://spotifyfollow.a2hosted.com/";
            var url = window.location.href;
            var sections = url.split('/');
            return sections[3];
        }
        
        function getPageFromURL()
        {
            var prefix = "https://spotifyfollow.a2hosted.com/";
            var url = window.location.href;
            var sections = url.split('/');
            return sections[4];
        }
        
        var ENVIRONMENT = getEnvironmentFromURL();
        var PAGE = getPageFromURL();
        
        var xmlHttpRequest = new XMLHttpRequest();
        
        var access_token = null;
        var refresh_token = null;
        var display_name = null;
        var spotify_id = null;
        var total_songs_liked = null;
        var new_songs_liked = null;
        var total_artists_followed = null;
        var new_artists_followed = null;
        var total_playlists_followed = null;
        var new_playlists_followed = null;
        var total_episodes_saved = null;
        var new_episodes_saved = null;
        var total_shows_saved = null;
        var new_shows_saved = null;
        var previous_week = 0;
        var userTier = -1;
        var discordIds = null;
        var currentDiscordIds = [];
        var discordRoles = null;
        var pointsPresetOptions = ['None', 'Top 20', 'CC', '10 ?', 'Thursday Song Share', 'Podcast', 'Flash 1', 'Flash 2', 'Ed', 'Vote', 'Vix', 'Stop Payola', 'Metal Radio', 'Show', 'New Release Radar', 'BNIM 2023'];
        var pointsPresetValues = ['', 5, 5, 5, 5, 5, 5, 10, 5, 5, 5, 5, 1, 5, 5, 2];
        var pointsPresetReasons = ['', 'Top 20', 'CC', '10 ?', 'Thursday Song Share', 'Podcast', 'Flash 1', 'Flash 2', 'Ed', 'Vote', 'Vix', 'Stop Payola', 'Metal Radio', 'Show', 'New Release Radar', 'BNIM 2023'];
        
        var last_access_token_refresh = null;
        var post_refresh_update_callback = null;
        
        var discordId = -1;
        var pointsReason = null;
        var pointsAmount = 0;
        
        function disableButtons()
        {
            document.getElementById("fullReport").disabled = true;
            document.getElementById("printLeaderboard").disabled = true;
            document.getElementById("bonusPointsToUserButton").disabled = true;
            document.getElementById("bonusPointsToRoleButton").disabled = true;
            document.getElementById("printTierToDiscordButton").disabled = true;
            document.getElementById("exportModPointsbutton").disabled = true;
            document.getElementById("exportBonusPointsbutton").disabled = true;
        }
        
        function enableButtons()
        {
            document.getElementById("fullReport").disabled = false;
            document.getElementById("printLeaderboard").disabled = false;
            document.getElementById("bonusPointsToUserButton").disabled = false;
            document.getElementById("bonusPointsToRoleButton").disabled = false;
            document.getElementById("printTierToDiscordButton").disabled = false;
            document.getElementById("exportModPointsbutton").disabled = false;
            document.getElementById("exportBonusPointsbutton").disabled = false;
        }
    
        function getHashParams()
        {
            var hashParams = {};
            var e, r = /([^&;=]+)=?([^&;]*)/g, q = window.location.hash.substring(1);
            while ( e = r.exec(q))
            {
                hashParams[e[1]] = decodeURIComponent(e[2]);
            }
            return hashParams;
        }
    
        function onBodyLoaded()
        {
            document.getElementById("welcomeMessage").innerHTML = "Hi";
                
            var params = getHashParams();
            
            if(params.access_token != null && params.refresh_token != null)
            {
                // Populate Presets Dropdown
                var pointsPresetDropdown = document.getElementById('pointsPreset');
                var index = 0;
                
                for(i = 0; i < pointsPresetOptions.length; i++)
                {
                    pointsPresetDropdown.options[i] = new Option(pointsPresetOptions[i], pointsPresetOptions[i]);
                }
                    
                last_access_token_refresh = new Date();
                
                access_token = params.access_token;
                refresh_token = params.refresh_token;
                
                document.getElementById("welcomeMessage").innerHTML = "";
                document.getElementById("loginButton").style.visibility = "hidden";
                
                xmlHttpRequest = new XMLHttpRequest();
                
                xmlHttpRequest.open("GET", 'https://spotifyfollow.a2hosted.com/' + ENVIRONMENT + '/' + PAGE + '_user_info?refresh_token=' + refresh_token + '&access_token=' + access_token, true);
                xmlHttpRequest.onreadystatechange = onUserInfoReceived;
                xmlHttpRequest.send();
            }
            else
            {
                document.getElementById("welcomeMessage").innerHTML = "Click the login button to sign in with Spotify, and have access to all the NAS tools";
        
                document.getElementById("login").style.display = "block";
                document.getElementById("loggedin").style.display = "none";
            }
        }
        
        function onUserInfoReceived()
        {
            if (this.readyState == 4 && this.status == 200)
            {
               var result = 'Success';
               var jsonResponse = JSON.parse(xmlHttpRequest.response);
               if(jsonResponse != null)
               {
                   if(jsonResponse.result != null)
                   {
                       result = jsonResponse.result;
                   }
                   if(jsonResponse.display_name != null)
                   {
                       display_name = jsonResponse.display_name;
                   }
                   if(jsonResponse.id != null)
                   {
                       spotify_id = jsonResponse.id;
                   }
               }
               
               if(result == 'Success')
               {
                    document.getElementById("results1").innerHTML = "Welcome " + display_name;
                    
                    document.getElementById("login").style.display = "none";
                    document.getElementById("loggedin").style.display = "block";
                    document.getElementById("DiscordIdDiv").style.display = "none";
                    document.getElementById("UserSelectDiv").style.display = "none";
                    document.getElementById("FullReportDiv").style.display = "none";
                    document.getElementById("PrintLeaderboardDiv").style.display = "none";
                    document.getElementById("AddBonusPointsToUserDiv").style.display = "none";
                    document.getElementById("pointsPresetDiv").style.display = "none";
                    document.getElementById("AddBonusPointsToRoleDiv").style.display = "none";
                    document.getElementById("PrintTierDiv").style.display = "none";
                    document.getElementById("ExportModPointsDiv").style.display = "none";
                    document.getElementById("ExportBonusPointsDiv").style.display = "none";
                    
                    document.getElementById("resultsDash").style.visibility = "hidden";
                    document.getElementById("choiceDash").style.visibility = "hidden";
               }
               else
               {
                    document.getElementById("results1").innerHTML = "An Error Occured";
                    location.replace('https://spotifyfollow.a2hosted.com/' + ENVIRONMENT + '/' + PAGE);
               }
            }
        }
        
        function tokenSafeCall(callback)
        {
            if(shouldRefreshAccessToken())
            {
                document.getElementById("results2").innerHTML = "Processing...";
                document.getElementById("results3").innerHTML = "";
                document.getElementById("results4").innerHTML = "";
                document.getElementById("results5").innerHTML = "";
                document.getElementById("results6").innerHTML = "";
                document.getElementById("results7").innerHTML = "";
                
                refreshAccessToken(callback);
            }
            else
            {
                callback();
            }
        }
        
        function shouldRefreshAccessToken()
        {
            var currentdate = new Date(); 
                
            if(last_access_token_refresh != null)
            {
                var seconds = (currentdate.getTime() - last_access_token_refresh.getTime()) / 1000;
                
                return (seconds > (50 * 60)); // Update refresh token if older than 55 minutes
            }
            else
            {
                last_access_token_refresh = currentdate;
                return true;
            }
        }
        
        function refreshAccessToken(onCompleteCallback)
        {
            post_refresh_update_callback = onCompleteCallback;
            
            xmlHttpRequest = new XMLHttpRequest();
           
            xmlHttpRequest.open("GET", 'https://spotifyfollow.a2hosted.com/' + ENVIRONMENT + '/refresh_access_token?refresh_token=' + refresh_token + 
                '&access_token=' + access_token +
                '&spotify_name=' + display_name +
                '&spotify_id=' + spotify_id, true);
            xmlHttpRequest.onreadystatechange = onRefreshAccessTokenComplete;
            xmlHttpRequest.send();
        }
        
        function onRefreshAccessTokenComplete()
        {
            if (this.readyState == 4 && this.status == 200)
            {
                var result = 'Success';
                var message = '';
                var jsonResponse = JSON.parse(xmlHttpRequest.response);
                if(jsonResponse != null)
                {
                    if(jsonResponse.result != null)
                    {
                       result = jsonResponse.result;
                    }
                    if(jsonResponse.message != null)
                    {
                       message = jsonResponse.message;
                    }
                    if(jsonResponse.access_token != null)
                    {
                       access_token = jsonResponse.access_token;
                    }
                }
                
                if(result == 'Success')
                {
                    last_access_token_refresh = new Date(); 
                    location.replace('https://spotifyfollow.a2hosted.com/' + ENVIRONMENT + '/' + PAGE + '/#access_token=' + access_token + '&refresh_token=' + refresh_token);
                    
                    if(post_refresh_update_callback != null)
                    {
                        post_refresh_update_callback();
                        post_refresh_update_callback = null;
                    }
                }
                else if(message == 'Authentication Error')
                {
                    document.getElementById("results1").innerHTML = "An Error Occured";
                    location.replace('https://spotifyfollow.a2hosted.com/' + ENVIRONMENT + '/' + PAGE);
                }
                else
                {
                    document.getElementById("results1").innerHTML = "An Error Occured";
                }
            }
        }
        
        function onDiscordIdsComplete()
        {
            if (this.readyState == 4 && this.status == 200)
            {
               var result = 'Success';
               var message = '';
               var data = null;
               var jsonResponse = JSON.parse(xmlHttpRequest.response);
               if(jsonResponse != null)
               {
                   if(jsonResponse.result != null)
                   {
                       result = jsonResponse.result;
                   }
                   if(jsonResponse.message != null)
                   {
                       message = jsonResponse.message;
                   }
                   if(jsonResponse.data != null)
                   {
                       discordIds = jsonResponse.data;
                   }
               }
               
               if(discordIds != null)
               {
                    var discordUserDropdown = document.getElementById('discordUsers');
                    var index = 0;
                    
                    currentDiscordIds = [];
                        
                    discordIds.forEach(result => {
                        if(userTier == -1 || userTier == result[2])
                        {
                            currentDiscordIds.push(result[0]);
                            discordUserDropdown.options[index] = new Option(result[1], result[1]);
                            index++;
                        }
                    });
               }
               
               if(result != 'Success')
               {
                   if(message == 'Authentication Error')
                   {
                        document.getElementById("results1").innerHTML = "An Error Occured";
                        location.replace('https://spotifyfollow.a2hosted.com/' + ENVIRONMENT + '/' + PAGE);
                   }
                   else
                   {
                        document.getElementById("results1").innerHTML = "Error retrieving Discord Ids";
                   }
               }
            }
        }
        
        function onDiscordRolesComplete()
        {
            if (this.readyState == 4 && this.status == 200)
            {
               var result = 'Success';
               var message = '';
               var data = null;
               var jsonResponse = JSON.parse(xmlHttpRequest.response);
               if(jsonResponse != null)
               {
                   if(jsonResponse.result != null)
                   {
                       result = jsonResponse.result;
                   }
                   if(jsonResponse.message != null)
                   {
                       message = jsonResponse.message;
                   }
                   if(jsonResponse.data != null)
                   {
                       discordRoles = jsonResponse.data;
                   }
               }
               
               if(discordRoles != null)
               {
                    var discordRolesDropdown = document.getElementById('discordRoles');
                    var index = 0;
                        
                    discordRoles.forEach(result => {
                        discordRolesDropdown.options[index] = new Option(result[1], result[1]);
                        index++;
                    });
               }
               
               if(result != 'Success')
               {
                   if(message == 'Authentication Error')
                   {
                        document.getElementById("results1").innerHTML = "An Error Occured";
                        location.replace('https://spotifyfollow.a2hosted.com/' + ENVIRONMENT + '/' + PAGE);
                   }
                   else
                   {
                        document.getElementById("results1").innerHTML = "Error retrieving Discord Ids";
                   }
               }
            }
        }
        
        function onPointsPresetSelected(value)
        {
            var pointsPresetIndex = document.getElementById('pointsPreset').selectedIndex;
            var pointsPresetOption = pointsPresetOptions[pointsPresetIndex];
            var pointsPresetValue = pointsPresetValues[pointsPresetIndex];
            var pointsPresetReason = pointsPresetReasons[pointsPresetIndex];
            
            document.getElementById("pointsreason_box").value = pointsPresetReason;
            document.getElementById("pointsamount_box").value = pointsPresetValue;
            
            document.getElementById("rolepointsreason_box").value = pointsPresetReason;
            document.getElementById("rolepointsamount_box").value = pointsPresetValue;
        }
        
        function userTierRadioClicked(tier)
        {
            if(tier == "tier0")
            {
                userTier = 0;
            }
            else if(tier == "tier1")
            {
                userTier = 1;
            }
            else if(tier == "tier2")
            {
                userTier = 2;
            }
            else if(tier == "tier3")
            {
                userTier = 3;
            }
            else if(tier == "tier4")
            {
                userTier = 4;
            }
            else if(tier == "tier5")
            {
                userTier = 5;
            }
            else if(tier == "tier6")
            {
                userTier = 6;
            }
            else if(tier == "tier7")
            {
                userTier = 7;
            }
            else if(tier == "tier8")
            {
                userTier = 8;
            }
            else if(tier == "tierAll")
            {
                userTier = -1;
            }
            else if(tier == "mods")
            {
                userTier = 9;
            }
            
            if(discordIds != null)
            {
                var discordUserDropdown = document.getElementById('discordUsers');
                var index = 0;
                
                currentDiscordIds = [];
                
                var i, L = discordUserDropdown.options.length - 1;
                for(i = L; i >= 0; i--) {
                    discordUserDropdown.remove(i);
                }
                    
                discordIds.forEach(result => {
                    if(userTier == -1 || userTier == result[2])
                    {
                        currentDiscordIds.push(result[0]);
                        discordUserDropdown.options[index] = new Option(result[1], result[1]);
                        index++;
                    }
                });
            }
            else
            {
                xmlHttpRequest = new XMLHttpRequest();
                
                xmlHttpRequest.open("GET", 'https://spotifyfollow.a2hosted.com/' + ENVIRONMENT + '/get_discord_ids?refresh_token=' + refresh_token + 
                    '&access_token=' + access_token +
                    '&spotify_name=' + display_name +
                    '&spotify_id=' + spotify_id, true);
                xmlHttpRequest.onreadystatechange = onDiscordIdsComplete;
                xmlHttpRequest.send();
            }
        }
        
        function radioClicked(task)
        {
            document.getElementById("choiceDash").style.visibility = "visible";
            document.getElementById("resultsDash").style.visibility = "hidden";
            document.getElementById("results2").innerHTML = "";
            document.getElementById("results3").innerHTML = "";
            document.getElementById("results4").innerHTML = "";
            document.getElementById("results5").innerHTML = "";
            document.getElementById("results6").innerHTML = "";
            document.getElementById("results7").innerHTML = "";
            
            if(task == "GetFullReport")
            {
                document.getElementById("taskDescription").innerHTML = "Get a full report with all of a users regular points and bonus points for the week";
                document.getElementById("UserSelectDiv").style.display = "block";
                document.getElementById("FullReportDiv").style.display = "block";
                document.getElementById("PrintLeaderboardDiv").style.display = "none";
                document.getElementById("AddBonusPointsToUserDiv").style.display = "none";
                document.getElementById("pointsPresetDiv").style.display = "none";
                document.getElementById("AddBonusPointsToRoleDiv").style.display = "none";
                document.getElementById("PrintTierDiv").style.display = "none";
                document.getElementById("ExportModPointsDiv").style.display = "none";
                document.getElementById("ExportBonusPointsDiv").style.display = "none";
                
                if(discordIds == null)
                {
                    xmlHttpRequest = new XMLHttpRequest();
                    
                    xmlHttpRequest.open("GET", 'https://spotifyfollow.a2hosted.com/' + ENVIRONMENT + '/get_discord_ids?refresh_token=' + refresh_token + 
                        '&access_token=' + access_token +
                        '&spotify_name=' + display_name +
                        '&spotify_id=' + spotify_id, true);
                    xmlHttpRequest.onreadystatechange = onDiscordIdsComplete;
                    xmlHttpRequest.send();
                }
            }
            else if(task == "PrintLeaderboard")
            {
                document.getElementById("taskDescription").innerHTML = "Print the points leaderboard to discord";
                document.getElementById("DiscordIdDiv").style.display = "none";
                document.getElementById("UserSelectDiv").style.display = "none";
                document.getElementById("FullReportDiv").style.display = "none";
                document.getElementById("PrintLeaderboardDiv").style.display = "block";
                document.getElementById("AddBonusPointsToUserDiv").style.display = "none";
                document.getElementById("pointsPresetDiv").style.display = "none";
                document.getElementById("AddBonusPointsToRoleDiv").style.display = "none";
                document.getElementById("PrintTierDiv").style.display = "none";
                document.getElementById("ExportModPointsDiv").style.display = "none";
                document.getElementById("ExportBonusPointsDiv").style.display = "none";
            }
            else if(task == "AddBonusPointsToUser")
            {
                document.getElementById("taskDescription").innerHTML = "Add bonus points to a specific user";
                document.getElementById("DiscordIdDiv").style.display = "none";
                document.getElementById("UserSelectDiv").style.display = "block";
                document.getElementById("FullReportDiv").style.display = "none";
                document.getElementById("PrintLeaderboardDiv").style.display = "none";
                document.getElementById("AddBonusPointsToUserDiv").style.display = "block";
                document.getElementById("pointsPresetDiv").style.display = "block";
                document.getElementById("AddBonusPointsToRoleDiv").style.display = "none";
                document.getElementById("PrintTierDiv").style.display = "none";
                document.getElementById("ExportModPointsDiv").style.display = "none";
                document.getElementById("ExportBonusPointsDiv").style.display = "none";
                
                if(discordIds == null)
                {
                    xmlHttpRequest = new XMLHttpRequest();
                    
                    xmlHttpRequest.open("GET", 'https://spotifyfollow.a2hosted.com/' + ENVIRONMENT + '/get_discord_ids?refresh_token=' + refresh_token + 
                        '&access_token=' + access_token +
                        '&spotify_name=' + display_name +
                        '&spotify_id=' + spotify_id, true);
                    xmlHttpRequest.onreadystatechange = onDiscordIdsComplete;
                    xmlHttpRequest.send();
                }
            }
            else if(task == "AddBonusPointsToRole")
            {
                document.getElementById("taskDescription").innerHTML = "Add bonus points to everyone who has the given role";
                document.getElementById("DiscordIdDiv").style.display = "none";
                document.getElementById("UserSelectDiv").style.display = "none";
                document.getElementById("FullReportDiv").style.display = "none";
                document.getElementById("PrintLeaderboardDiv").style.display = "none";
                document.getElementById("AddBonusPointsToUserDiv").style.display = "none";
                document.getElementById("pointsPresetDiv").style.display = "block";
                document.getElementById("AddBonusPointsToRoleDiv").style.display = "block";
                document.getElementById("PrintTierDiv").style.display = "none";
                document.getElementById("ExportModPointsDiv").style.display = "none";
                document.getElementById("ExportBonusPointsDiv").style.display = "none";
                
                if(discordRoles == null)
                {
                    xmlHttpRequest = new XMLHttpRequest();
                   
                    xmlHttpRequest.open("GET", 'https://spotifyfollow.a2hosted.com/' + ENVIRONMENT + '/get_discord_roles?refresh_token=' + refresh_token + 
                        '&access_token=' + access_token +
                        '&spotify_name=' + display_name +
                        '&spotify_id=' + spotify_id, true);
                    xmlHttpRequest.onreadystatechange = onDiscordRolesComplete;
                    xmlHttpRequest.send();
                }
            }
            else if(task == "PrintTierToDiscord")
            {
                document.getElementById("taskDescription").innerHTML = "Print a list of everyone in a tier to discord";
                document.getElementById("DiscordIdDiv").style.display = "none";
                document.getElementById("UserSelectDiv").style.display = "none";
                document.getElementById("FullReportDiv").style.display = "none";
                document.getElementById("PrintLeaderboardDiv").style.display = "none";
                document.getElementById("AddBonusPointsToUserDiv").style.display = "none";
                document.getElementById("pointsPresetDiv").style.display = "none";
                document.getElementById("AddBonusPointsToRoleDiv").style.display = "none";
                document.getElementById("PrintTierDiv").style.display = "block";
                document.getElementById("ExportModPointsDiv").style.display = "none";
                document.getElementById("ExportBonusPointsDiv").style.display = "none";
            }
            else if(task == "ExportModPoints")
            {
                document.getElementById("taskDescription").innerHTML = "Print a list of everyone in a tier to discord";
                document.getElementById("DiscordIdDiv").style.display = "none";
                document.getElementById("UserSelectDiv").style.display = "none";
                document.getElementById("FullReportDiv").style.display = "none";
                document.getElementById("PrintLeaderboardDiv").style.display = "none";
                document.getElementById("AddBonusPointsToUserDiv").style.display = "none";
                document.getElementById("pointsPresetDiv").style.display = "none";
                document.getElementById("AddBonusPointsToRoleDiv").style.display = "none";
                document.getElementById("PrintTierDiv").style.display = "none";
                document.getElementById("ExportModPointsDiv").style.display = "block";
                document.getElementById("ExportBonusPointsDiv").style.display = "none";
            }
            else if(task == "ExportBonusPoints")
            {
                document.getElementById("taskDescription").innerHTML = "Export all bonus points assigned for the given week";
                document.getElementById("DiscordIdDiv").style.display = "none";
                document.getElementById("UserSelectDiv").style.display = "none";
                document.getElementById("FullReportDiv").style.display = "none";
                document.getElementById("PrintLeaderboardDiv").style.display = "none";
                document.getElementById("AddBonusPointsToUserDiv").style.display = "none";
                document.getElementById("pointsPresetDiv").style.display = "none";
                document.getElementById("AddBonusPointsToRoleDiv").style.display = "none";
                document.getElementById("PrintTierDiv").style.display = "none";
                document.getElementById("ExportModPointsDiv").style.display = "none";
                document.getElementById("ExportBonusPointsDiv").style.display = "block";
            }
        }
        
        function weekClicked(week)
        {
            if(week == "CurrentWeek")
            {
                previous_week = 0;
            }
            else if(week == "PreviousWeek")
            {
                previous_week = 1;
            }
            else if(week == "TwoWeeksAgo")
            {
                previous_week = 2;
            }
        }
        
        function onFullReportButtonPressed()
        {
            disableButtons();
            tokenSafeCall(getFullReport);
        }
        
        function getFullReport()
        {
            var discord_user_index = document.getElementById('discordUsers').selectedIndex;
            var discordId = currentDiscordIds[discord_user_index];
            xmlHttpRequest = new XMLHttpRequest();
           
            xmlHttpRequest.open("GET", 'https://spotifyfollow.a2hosted.com/' + ENVIRONMENT + '/user_report?refresh_token=' + refresh_token + 
                '&access_token=' + access_token +
                '&spotify_name=' + display_name +
                '&spotify_id=' + spotify_id +
                '&discord_id=' + discordId +
                '&previous_week=' + previous_week, true);
            xmlHttpRequest.onreadystatechange = onFullReportComplete;
            xmlHttpRequest.send();
            
            document.getElementById("resultsDash").style.visibility = "visible";
            document.getElementById("results2").innerHTML = "Generating Full Report...";
            document.getElementById("results3").innerHTML = "";
            document.getElementById("results4").innerHTML = "";
            document.getElementById("results5").innerHTML = "";
            document.getElementById("results6").innerHTML = "";
            document.getElementById("results7").innerHTML = "";
        }
        
        function onFullReportComplete()
        {
            enableButtons();
            
            if (this.readyState == 4 && this.status == 200)
            {
               var result = 'Success';
               var message = '';
               var data = null;
               var jsonResponse = JSON.parse(xmlHttpRequest.response);
               if(jsonResponse != null)
               {
                   if(jsonResponse.result != null)
                   {
                       result = jsonResponse.result;
                   }
                   if(jsonResponse.message != null)
                   {
                       message = jsonResponse.message;
                   }
                   if(jsonResponse.data != null)
                   {
                       data = jsonResponse.data;
                   }
               }
               
               if(result == 'Success')
               {
                    var element = document.createElement('a');
                    
                    element.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(data));
                    element.setAttribute('download', "downloads.txt");
                    
                    element.style.display = 'none';
                    document.body.appendChild(element);
                    
                    element.click();
                    
                    document.body.removeChild(element);
                    
                    document.getElementById("results3").innerHTML = "Success";
               }
               else if(message == 'Authentication Error')
               {
                    document.getElementById("results3").innerHTML = "An Error Occured";
                    location.replace('https://spotifyfollow.a2hosted.com/' + ENVIRONMENT + '/' + PAGE);
               }
               else
               {
                    document.getElementById("results3").innerHTML = "An Error Occured";
               }
            }
        }
        
        function onPrintLeaderboardButtonPressed()
        {
            disableButtons();
            tokenSafeCall(printLeaderboard);
        }
        
        function printLeaderboard()
        {
            var leaderboardLength = document.getElementById("leaderboardlength").value;
            xmlHttpRequest = new XMLHttpRequest();
           
            xmlHttpRequest.open("GET", 'https://spotifyfollow.a2hosted.com/' + ENVIRONMENT + '/print_leaderboard?refresh_token=' + refresh_token + 
                '&access_token=' + access_token +
                '&spotify_name=' + display_name +
                '&spotify_id=' + spotify_id +
                '&leaderboard_length=' + leaderboardLength, true);
            xmlHttpRequest.onreadystatechange = onPrintLeaderboardComplete;
            xmlHttpRequest.send();
            
            document.getElementById("resultsDash").style.visibility = "visible";
            document.getElementById("results2").innerHTML = "Printing Leaderboard...";
            document.getElementById("results3").innerHTML = "";
            document.getElementById("results4").innerHTML = "";
            document.getElementById("results5").innerHTML = "";
            document.getElementById("results6").innerHTML = "";
            document.getElementById("results7").innerHTML = "";
        }
        
        function onPrintLeaderboardComplete()
        {
            enableButtons();
            
            if (this.readyState == 4 && this.status == 200)
            {
               var result = 'Success';
               var message = '';
               var data = null;
               var jsonResponse = JSON.parse(xmlHttpRequest.response);
               if(jsonResponse != null)
               {
                   if(jsonResponse.result != null)
                   {
                       result = jsonResponse.result;
                   }
                   if(jsonResponse.message != null)
                   {
                       message = jsonResponse.message;
                   }
                   if(jsonResponse.data != null)
                   {
                       data = jsonResponse.data;
                   }
               }
               
               if(result == 'Success')
               {
                    document.getElementById("results3").innerHTML = "Success";
               }
               else if(message == 'Authentication Error')
               {
                    document.getElementById("results3").innerHTML = "An Error Occured";
                    location.replace('https://spotifyfollow.a2hosted.com/' + ENVIRONMENT + '/' + PAGE);
               }
               else
               {
                    document.getElementById("results3").innerHTML = "An Error Occured";
               }
            }
        }
        
        function onBonusPointsToUserButtonPressed()
        {
            disableButtons();
            tokenSafeCall(grantBonusPointsToUser);
        }
        
        function grantBonusPointsToUser()
        {
            var discord_user_index = document.getElementById('discordUsers').selectedIndex;
                
            if(discordId == currentDiscordIds[discord_user_index] &&
                pointsReason == document.getElementById("pointsreason_box").value &&
                pointsAmount == document.getElementById("pointsamount_box").value)
            {
                document.getElementById("results2").innerHTML = "Possible Duplicate";
                document.getElementById("results3").innerHTML = "Points Reason and Points Amount haven't changed since previous points";
                document.getElementById("results4").innerHTML = "";
                document.getElementById("results5").innerHTML = "";
                document.getElementById("results6").innerHTML = "";
                document.getElementById("results7").innerHTML = "";
                
                discordId = -1;
                pointsReason = null;
                pointsAmount = 0;
                
                enableButtons();
            }
            else
            {
                discordId = currentDiscordIds[discord_user_index];
                pointsReason = document.getElementById("pointsreason_box").value;
                pointsAmount = document.getElementById("pointsamount_box").value;
                
                xmlHttpRequest = new XMLHttpRequest();
                
                xmlHttpRequest.open("GET", 'https://spotifyfollow.a2hosted.com/' + ENVIRONMENT + '/add_bonus_points?refresh_token=' + refresh_token + 
                    '&access_token=' + access_token +
                    '&spotify_name=' + display_name +
                    '&spotify_id=' + spotify_id +
                    '&discord_id=' + discordId +
                    '&points_reason=' + pointsReason +
                    '&points_amount=' + pointsAmount, true);
                    
                xmlHttpRequest.onreadystatechange = onAddBonusPointsComplete;
                xmlHttpRequest.send();
                
                document.getElementById("resultsDash").style.visibility = "visible";
                document.getElementById("results2").innerHTML = "Adding Bonus Points...";
                document.getElementById("results3").innerHTML = "";
                document.getElementById("results4").innerHTML = "";
                document.getElementById("results5").innerHTML = "";
                document.getElementById("results6").innerHTML = "";
                document.getElementById("results7").innerHTML = "";
            }
        }
        
        function onBonusPointsToRoleButtonPressed()
        {
            disableButtons();
            tokenSafeCall(grantBonusPointsToRole);
        }
        
        function grantBonusPointsToRole()
        {
            var discord_role_index = document.getElementById('discordRoles').selectedIndex;
                
            if(discordId == discordRoles[discord_role_index][0] &&
                pointsReason == document.getElementById("rolepointsreason_box").value &&
                pointsAmount == document.getElementById("rolepointsamount_box").value)
            {
                document.getElementById("results2").innerHTML = "Possible Duplicate";
                document.getElementById("results3").innerHTML = "Points Reason and Points Amount haven't changed since previous points";
                document.getElementById("results4").innerHTML = "";
                document.getElementById("results5").innerHTML = "";
                document.getElementById("results6").innerHTML = "";
                document.getElementById("results7").innerHTML = "";
                
                discordId = -1;
                pointsReason = null;
                pointsAmount = 0;
                
                enableButtons();
            }
            else
            {
                discordId = discordRoles[discord_role_index][0];
                pointsReason = document.getElementById("rolepointsreason_box").value;
                pointsAmount = document.getElementById("rolepointsamount_box").value;
                
                xmlHttpRequest = new XMLHttpRequest();
                
                xmlHttpRequest.open("GET", 'https://spotifyfollow.a2hosted.com/' + ENVIRONMENT + '/add_bonus_points?refresh_token=' + refresh_token + 
                    '&access_token=' + access_token +
                    '&spotify_name=' + display_name +
                    '&spotify_id=' + spotify_id +
                    '&discord_id=' + discordId +
                    '&points_reason=' + pointsReason +
                    '&points_amount=' + pointsAmount, true);
                    
                xmlHttpRequest.onreadystatechange = onAddBonusPointsComplete;
                xmlHttpRequest.send();
                
                document.getElementById("resultsDash").style.visibility = "visible";
                document.getElementById("results2").innerHTML = "Adding Bonus Points...";
                document.getElementById("results3").innerHTML = "";
                document.getElementById("results4").innerHTML = "";
                document.getElementById("results5").innerHTML = "";
                document.getElementById("results6").innerHTML = "";
                document.getElementById("results7").innerHTML = "";
            }
        }
        
        function onAddBonusPointsComplete()
        {
            enableButtons();
            
            if (this.readyState == 4 && this.status == 200)
            {
               var result = 'Success';
               var message = '';
               var data = null;
               var jsonResponse = JSON.parse(xmlHttpRequest.response);
               if(jsonResponse != null)
               {
                   if(jsonResponse.result != null)
                   {
                       result = jsonResponse.result;
                   }
                   if(jsonResponse.message != null)
                   {
                       message = jsonResponse.message;
                   }
                   if(jsonResponse.data != null)
                   {
                       data = jsonResponse.data;
                   }
               }
               
               if(result == 'Success')
               {
                    document.getElementById("results3").innerHTML = "Success";
               }
               else if(message == 'Authentication Error')
               {
                    document.getElementById("results3").innerHTML = "An Error Occured";
                    location.replace('https://spotifyfollow.a2hosted.com/' + ENVIRONMENT + '/' + PAGE);
               }
               else
               {
                    document.getElementById("results3").innerHTML = "An Error Occured";
               }
            }
        }
        
        function onPrintTierToDiscordButtonPressed()
        {
            disableButtons();
            tokenSafeCall(printTierToDiscord);
        }
        
        function printTierToDiscord()
        {
            var tier = document.getElementById("tier_box").value;
            
            xmlHttpRequest = new XMLHttpRequest();
            
            xmlHttpRequest.open("GET", 'https://spotifyfollow.a2hosted.com/' + ENVIRONMENT + '/print_tier?refresh_token=' + refresh_token + 
                '&access_token=' + access_token +
                '&spotify_name=' + display_name +
                '&spotify_id=' + spotify_id +
                '&previous_week=' + 0 +
                '&tier=' + tier, true);
                
            xmlHttpRequest.onreadystatechange = onPrintTierToDiscordComplete;
            xmlHttpRequest.send();
            
            document.getElementById("resultsDash").style.visibility = "visible";
            document.getElementById("results2").innerHTML = "Printing tier...";
            document.getElementById("results3").innerHTML = "";
            document.getElementById("results4").innerHTML = "";
            document.getElementById("results5").innerHTML = "";
            document.getElementById("results6").innerHTML = "";
            document.getElementById("results7").innerHTML = "";
        }
        
        function onPrintTierToDiscordComplete()
        {
            enableButtons();
            if (this.readyState == 4 && this.status == 200)
            {
                var result = 'Success';
                var message = '';
                var data = null;
                var jsonResponse = JSON.parse(xmlHttpRequest.response);
                if(jsonResponse != null)
                {
                    if(jsonResponse.result != null)
                    {
                       result = jsonResponse.result;
                    }
                    if(jsonResponse.message != null)
                    {
                       message = jsonResponse.message;
                    }
                    if(jsonResponse.data != null)
                    {
                       data = jsonResponse.data;
                    }
                }
                
                if(result == 'Success')
                {
                    document.getElementById("results3").innerHTML = "Success";
                }
                else if(message == 'Authentication Error')
                {
                    document.getElementById("results3").innerHTML = "An Error Occured";
                    location.replace('https://spotifyfollow.a2hosted.com/' + ENVIRONMENT + '/' + PAGE);
                }
                else
                {
                    document.getElementById("results3").innerHTML = "An Error Occured";
                    document.getElementById("results4").innerHTML = message;
                }
            }
        }
        
        function onExportModPointsbuttonPressed()
        {
            disableButtons();
            tokenSafeCall(exportModPoints);
        }
        
        function exportModPoints()
        {
            var tier = document.getElementById("tier_box").value;
            
            xmlHttpRequest = new XMLHttpRequest();
            
            xmlHttpRequest.open("GET", 'https://spotifyfollow.a2hosted.com/' + ENVIRONMENT + '/export_mod_points?refresh_token=' + refresh_token + 
                '&access_token=' + access_token +
                '&spotify_name=' + display_name +
                '&spotify_id=' + spotify_id +
                '&previous_week=' + previous_week, true);
                
            xmlHttpRequest.onreadystatechange = onExportModPointsComplete;
            xmlHttpRequest.send();
            
            document.getElementById("resultsDash").style.visibility = "visible";
            document.getElementById("results2").innerHTML = "Exporting Mod Points...";
            document.getElementById("results3").innerHTML = "";
            document.getElementById("results4").innerHTML = "";
            document.getElementById("results5").innerHTML = "";
            document.getElementById("results6").innerHTML = "";
            document.getElementById("results7").innerHTML = "";
        }
        
        function onExportModPointsComplete()
        {
            enableButtons();
            if (this.readyState == 4 && this.status == 200)
            {
               var result = 'Success';
               var message = '';
               var data = null;
               var jsonResponse = JSON.parse(xmlHttpRequest.response);
               if(jsonResponse != null)
               {
                   if(jsonResponse.result != null)
                   {
                       result = jsonResponse.result;
                   }
                   if(jsonResponse.message != null)
                   {
                       message = jsonResponse.message;
                   }
                   if(jsonResponse.data != null)
                   {
                       data = jsonResponse.data;
                   }
               }
               
               if(result == 'Success')
               {
                    var element = document.createElement('a');
                    
                    element.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(data));
                    element.setAttribute('download', "mods.txt");
                    
                    element.style.display = 'none';
                    document.body.appendChild(element);
                    
                    element.click();
                    
                    document.body.removeChild(element);
                    
                    document.getElementById("results3").innerHTML = "Success";
               }
               else if(message == 'Authentication Error')
               {
                    document.getElementById("results1").innerHTML = "An Error Occured";
                    location.replace('https://spotifyfollow.a2hosted.com/' + ENVIRONMENT + '/' + PAGE);
               }
               else
               {
                    document.getElementById("results1").innerHTML = "An Error Occured";
               }
            }
        }
        
        function onExportBonusPointsbuttonPressed()
        {
            disableButtons();
            tokenSafeCall(exportBonusPoints);
        }
        
        function exportBonusPoints()
        {
            xmlHttpRequest = new XMLHttpRequest();
            
            xmlHttpRequest.open("GET", 'https://spotifyfollow.a2hosted.com/' + ENVIRONMENT + '/export_bonus_points?refresh_token=' + refresh_token + 
                '&access_token=' + access_token +
                '&spotify_name=' + display_name +
                '&spotify_id=' + spotify_id +
                '&previous_week=' + previous_week, true);
                
            xmlHttpRequest.onreadystatechange = onExportBonusPointsComplete;
            xmlHttpRequest.send();
            
            document.getElementById("resultsDash").style.visibility = "visible";
            document.getElementById("results2").innerHTML = "Exporting Bonus Points...";
            document.getElementById("results3").innerHTML = "";
            document.getElementById("results4").innerHTML = "";
            document.getElementById("results5").innerHTML = "";
            document.getElementById("results6").innerHTML = "";
            document.getElementById("results7").innerHTML = "";
        }
        
        function onExportBonusPointsComplete()
        {
            enableButtons();
            if (this.readyState == 4 && this.status == 200) {
               var result = 'Success';
               var message = '';
               var data = null;
               var jsonResponse = JSON.parse(xmlHttpRequest.response);
               if(jsonResponse != null)
               {
                   if(jsonResponse.result != null)
                   {
                       result = jsonResponse.result;
                   }
                   if(jsonResponse.message != null)
                   {
                       message = jsonResponse.message;
                   }
                   if(jsonResponse.data != null)
                   {
                       data = jsonResponse.data;
                   }
               }
               
               if(result == 'Success')
               {
                    var fileName = "bonusPointsCurrentWeek.csv";
                    
                    if(previous_week == 1)
                    {
                        fileName = "bonusPointsPreviousWeek.csv";
                    }
                    else if(previous_week == 2)
                    {
                        fileName = "bonusPointsTwoWeeksAgo.csv";
                    }
                    
                    var element = document.createElement('a');
                    
                    element.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(data));
                    element.setAttribute('download', fileName);
                    
                    element.style.display = 'none';
                    document.body.appendChild(element);
                    
                    element.click();
                    
                    document.body.removeChild(element);
                    
                    document.getElementById("results3").innerHTML = "Success";
               }
               else if(message == 'Authentication Error')
               {
                    document.getElementById("results1").innerHTML = "An Error Occured";
                    location.replace('https://spotifyfollow.a2hosted.com/' + ENVIRONMENT + '/' + PAGE);
               }
               else
               {
                    document.getElementById("results1").innerHTML = "An Error Occured";
               }
            }
        }
        
        function onLogoutPressed()
        {
            const url = 'https://www.spotify.com/logout/';
            const spotifyLogoutWindow = window.open(url, 'Spotify Logout', 'width=700,height=500,top=40,left=40');
            setTimeout(() => 
            {
                spotifyLogoutWindow.close();
                location.replace('https://spotifyfollow.a2hosted.com/' + ENVIRONMENT + '/' + PAGE);
            }, 1000);
        }
        
    </script>
  </body>
</html>